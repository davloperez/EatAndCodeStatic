<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Blog personal de David López, programador web en Xepient Solutions. Aquí podrás encontrar artículos relacionados con la programación web, herramientas y otras reflexiones.">
    

    <!--Author-->
    
        <meta name="author" content="David López Pérez">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Lecciones aprendidas de 2 proyectos con el mismo código fuente"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Blog personal de David López, programador web en Xepient Solutions. Aquí podrás encontrar artículos relacionados con la programación web, herramientas y otras reflexiones." />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Eat&amp;Code"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    
        <meta property="og:image" content="http://eatandcode.es/images/wonder-woman.jpg" />
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>Lecciones aprendidas de 2 proyectos con el mismo código fuente - Eat&amp;Code</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />
	
	
		<link rel="amphtml" href="http://eatandcode.es/2016/06/02/Lecciones_aprendidas_de_2_proyectos_con_el_mismo_codigo_fuente/amp/index.html">
	

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-73435519-2', 'auto');
        ga('send', 'pageview');

    </script>



</head>

<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Eat&Code</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Inicio
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archivos
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://twitter.com/DavidCehegin">
                            
                                &nbsp;<i class="fa fa-twitter fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://eatandcode.es/images/blog-header.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Lecciones aprendidas de 2 proyectos con el mismo código fuente</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        02-06-2016
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/MEAN-Stack/">#MEAN Stack</a> <a href="/tags/OAuth-2-0/">#OAuth 2.0</a> <a href="/tags/Framework/">#Framework</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/web/">web</a>/ <a href="/categories/web/arquitectura/">arquitectura</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Hace un tiempo, un cliente nos pidió a mí y a mi equipo que le desarrolláramos un prototipo para una herramienta de creación de test psicotécnicos. Disponíamos de tiempo de sobra para hacerlo, de modo que aprovechamos para investigar sobre tecnologías diferentes a las que habíamos usado hasta ahora. Nos decantamos por hacerlo todo con <a href="http://www.cantabriatic.com/arquitecturas-web-y-mean-stack/" target="_blank" rel="external">MEAN Stack</a> y orientando la arquitectura hacia microservicios (sencilla, todo muy manual y sin complicarnos demasiado, que era para un prototipo).</p>
<p>Al poco tiempo de comenzar el desarrollo, cuando aún no llebábamos ni el 40% del trabajo hecho, el mismo cliente nos pidió hacer otro nuevo prototipo para una cosa totalmente diferente, una herramienta de análisis de voz. Enseguida nos dimos cuenta de que los dos proyectos tenían una serie de características comunes:</p>
<ul>
<li>Los dos requerían de autenticación con usuario y password.</li>
<li>Los dos debían tener una interfaz de administración y otra para el resto de usuarios (es decir, necesitábamos crear un sistema de permisos o categorías de usuarios).</li>
<li>Ambos debían ser multiidioma.</li>
<li>A nivel de maquetación frontend, ambos eran similares en cuanto a la estructura principal de los elementos en pantalla.</li>
<li>Los dos proyectos serían MEAN Stack.</li>
<li>Las “compilaciones” de ambos proyectos serían similares: minificación y empaqueado de recursos, compilaciones específicas para entornos de pruebas y de producción, etc.</li>
</ul>
<p>Con todos estos puntos en común, parecía obvio que los proyectos nos estaban diciendo a gritos que reutilizásemos componentes comunes a ambos. Pero tras mucho meditarlo, decidimos ir un poco más allá y directamente <strong>implementar ambos proyectos bajo el mismo código fuente</strong>.</p>
<h2 id="¿Como-que-“dos-proyectos-con-el-mismo-codigo-fuente”"><a href="#¿Como-que-“dos-proyectos-con-el-mismo-codigo-fuente”" class="headerlink" title="¿Cómo que “dos proyectos con el mismo código fuente”?"></a>¿Cómo que “dos proyectos con el mismo código fuente”?</h2><p>El código fuente era el mismo para ambos, el mismo repositorio de código, etc. En realidad, ese “<em>framework</em>“ de 2 proyectos era en sí un único proyecto llamado <strong>wonder</strong>. Wonder porque era maravilloso, o al menos eso pensábamos al principio. Un código fuente que nos permitía crear 2 y más aplicaciones sin tener que ver nada la una con las otras… suena maravilloso, mágico, ¿verdad? wonder.</p>
<p>Aunque parezca mentira, para la implementación del 80% de los dos prototipos, wonder nos ahorró muchísimo trabajo. El sistema de autenticación era el mismo para ambas (implementamos un API <a href="http://oauth.net/2/" target="_blank" rel="external">OAuth 2.0</a> únicamente con la funcionalidad que necesitábamos), por lo que si encontrábamos un bug en este sistema, al solucionarlo se solucionaba en <strong>ambos proyectos a la vez</strong>. Lo mismo ocurría con la i18n, con el sistema de permisos, etc.</p>
<p><img src="/images/wonder-woman.jpg" alt="La &#39;wonder woman&#39; que querrás ver en el cine, no en tu código fuente" title="Wonder woman"><span class="image-caption">La &#39;wonder woman&#39; que querrás ver en el cine, no en tu código fuente</span></p>
<p>El problema vino con el 20% restante. Son esa serie de detalles que, aunque fuesen muy sutiles, diferenciaban en algunos aspectos a ambas aplicaciones. Por ejemplo, la aplicación de los test psicotécnicos requería que los usuarios se pudiesen asignar a “grupos”, entre los cuales compartían una serie de información relacionada a los tests que iban pasando; sin embargo, en la aplicación de análisis de voz estos grupos no existían, ni siquiera un concepto similar (cada usuario era totalmente independiente del resto). Cuando te encuentras una situación así, te ves en la necesida de decir: “Vale, pues entonces el <em>framework</em> wonder deberá exponer un parámetro de configuración llamado <em>‘gruposPermitidos’</em>, que podrá ser <em>true</em> o <em>false</em>. Entonces con Gulp, cuando estemos compilando la aplicación, se generará el código fuente final con esa característica o sin ella, según el valor de esa variable”. O también otro ejemplo: una de las aplicaciones debía estar en español e inglés, y la otra en español, inglés y portugués. ¿Cómo se resuelve esto? Pues poniendo X más <strong>variables de configuración</strong> que permitan indicar los idiomas disponibles, el idioma por defecto, etc.</p>
<p>Si empiezas a tirar del hilo, te das cuenta de que para poder conseguir esas “diferencias sutiles” entre ambos proyectos, probablemente tendrás que hacerlo de una manera mucho más compleja para que sea un mecanismo genérico, desacoplado de aplicaciónes concretas, cuando en realidad el modo de hacerlo si el proyecto fuese destinado para una única aplicación sería <em>mucho más sencillo y directo</em>.</p>
<h2 id="¿Hasta-que-punto-merece-la-pena-compartir-codigo-fuente-entre-proyectos"><a href="#¿Hasta-que-punto-merece-la-pena-compartir-codigo-fuente-entre-proyectos" class="headerlink" title="¿Hasta qué punto merece la pena compartir código fuente entre proyectos?"></a>¿Hasta qué punto merece la pena compartir código fuente entre proyectos?</h2><p>Compartir el código fuente mediante un <em>framework</em> tipo wonder podría merecer la pena si se dan los siguientes puntos:</p>
<ul>
<li>Si sabes que va a servir para 3 o más aplicaciones. Si es sólo para 2 aplicaciones, probablemente no merezca la pena.</li>
<li>Si las aplicaciones son <em>prototipos</em> sencillos de aplicaciones, que sirvan para testear una hipótesis o comprobar la atracción del mercado.</li>
<li>Si, obviamente, las diferencias entre las aplicaciones son muy (muy muy) pocas.</li>
</ul>
<p>Que se den estos 3 puntos es bastante poco probable, por lo que como regla general mi consejo es que si os encontráis en una situación similar a la mía, no optéis por compartir el código fuente. En su lugar, intentad buscar una alternativa basada en la paquetización (npm, NuGet..) de las partes comunes de ambas aplicaciones, y <strong>mantened el código fuente de cada aplicación por separado</strong>, añadiendo vuestras dependencias privadas necesarias (vía npm o del modo que sea) para reutilizar la funcionalidad entre ambas aplicaciones.</p>
<p>Esto último es <em>fácil de decir, pero difícil de hacer</em>, lo sé :) En un futuro explicaré cómo se puede implementar una solución como esa sin llegar a perder la cabeza en el intento.</p>


                
                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-574964d40b587768"></script>

                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_sharing_toolbox"></div>
                

            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Comentarios:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                        <li>
                            <a href="https://twitter.com/DavidCehegin" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                        <li>
                            <a href="https://www.linkedin.com/in/davloperez" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="/bootstrap/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'eatandcode';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</body>

</html>